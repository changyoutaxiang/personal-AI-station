# CLAUDE.md

这个文件为 Claude Code (claude.ai/code) 在这个代码库中工作时提供指导。

## 沟通语言要求
- **始终使用中文与用户沟通**，所有解释、注释和回复都使用简体中文
- **教育导向**：用户是编程初学者，刚开始使用 Claude Code，需要在编程过程中提供基础教育，让用户边用边学

## 常用命令（当前项目）

Digital Brain 项目核心开发命令：

- **开发服务器**：`npm run dev`（使用Turbopack加速）
- **构建项目**：`npm run build`（生产构建，代码质量检查）
- **代码检查**：`npm run lint`（ESLint代码质量保证）
- **类型检查**：`npm run typecheck`（TypeScript严格模式检查）
- **数据库状态**：`sqlite3 data/digital-brain.db "SELECT COUNT(*) FROM entries;"`（查看记录数量）
- **备份检查**：`ls -la data/backups/`（查看自动备份文件）
- **端口检查**：`lsof -i :3000`（确认端口占用状态）
- **进程清理**：`pkill -f "next"`（清理Node.js进程）
- **应用测试**：访问 `http://localhost:3000`（确认所有功能正常）

## 项目架构

### 技术栈
- **前端框架**：Next.js 15 + React + TypeScript
- **样式系统**：Tailwind CSS + 自定义主题系统
- **数据库**：SQLite + 事务处理
- **AI集成**：OpenRouter API + Claude模型
- **构建工具**：Turbopack（开发）+ Next.js优化（生产）

### 核心目录结构
```
src/
├── app/                    # Next.js应用页面
├── components/             # React组件
├── lib/                   # 核心逻辑和数据处理
├── types/                 # TypeScript类型定义
├── hooks/                 # 自定义React Hooks
├── styles/               # 样式文件
└── data/                 # 数据库和备份文件
```

### 核心功能模块
- **智能记录管理**：语音输入、AI润色、Markdown支持、拖拽排序
- **AI智能功能**：犀利提问、语义相似度分析、智能合并、智能周报
- **任务管理系统**：三维时间管理、状态流转、优先级管理、拖拽重排
- **搜索与发现**：智能搜索、拼音支持、结果高亮、搜索历史
- **数据管理系统**：多格式导出、备份管理、完整性验证
- **批量操作系统**：多选机制、批量删除、批量更新
- **主题体验系统**：三种完整主题、无缝切换、持久化存储、完整颜色标准化

## 开发规范

### 代码质量标准
- **TypeScript严格模式**：100%类型安全覆盖
- **ESLint规范**：保持代码质量和一致性
- **组件化设计**：单一职责、可复用、类型安全
- **错误处理**：完整的错误恢复机制和用户反馈

### 最佳实践
- **乐观更新模式**：UI立即响应，后台同步数据库
- **防抖机制**：避免频繁API调用，控制成本
- **渐进式开发**：数据层→逻辑层→组件层→集成层
- **用户体验优先**：功能完整性基础上的视觉简化

## 项目当前状态

**Digital Brain v2.8 - 主题系统完整版（最新版本）**

### 核心功能完整度：100%
✅ 所有主要功能模块已完成并经过验证
✅ 企业级代码质量标准（ESLint + TypeScript严格模式）
✅ 完整的用户体验优化
✅ 生产就绪状态
✅ 主题系统完整性（所有组件支持主题切换）

### 技术指标
- **构建状态**：Next.js构建100%成功
- **代码质量**：ESLint规范，TypeScript严格模式，无硬编码颜色
- **性能表现**：First Load JS < 100kB，优秀水平
- **用户体验**：核心操作3步以内，学习成本低
- **主题系统**：完整颜色标准化，支持无缝主题切换

### 最新改进（2025-08-08）
✅ **硬编码颜色全面修复** - 修复了6个核心组件中的所有硬编码颜色问题
✅ **主题系统完整性** - 所有组件现在完全支持主题切换功能
✅ **颜色标准化** - 统一使用主题系统的颜色变量，确保视觉一致性

## 开发建议

### 新功能开发
1. **先规划再实施**：明确功能目标和用户价值
2. **最小化增量开发**：独立模块，渐进验证
3. **保持架构一致性**：遵循现有的技术栈和设计模式
4. **注重用户体验**：功能完整性和易用性并重

### 问题解决
1. **系统性调试**：从数据库→服务器→前端逐层排查
2. **日志驱动诊断**：使用完整的调试日志追踪问题
3. **用户验证**：技术修复必须经过实际使用验证
4. **文档同步更新**：记录问题分析和解决过程

## 下一步发展方向

### 短期目标（1-2周）
- 移动端响应式优化
- 键盘操作体验增强
- 性能优化和组件按需加载

### 中期目标（1-2月）
- PWA支持和离线功能
- 个性化界面配置
- 高级AI功能扩展

### 长期愿景
- 多用户协作支持
- 跨平台应用开发
- 企业级部署方案

---
*Digital Brain - 智能个人效率管理系统*  
*最后更新：2025年8月3日*