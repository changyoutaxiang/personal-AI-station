# 主题与对比度设计规范

目的：确保亮色/暗色模式、不同主题下的文本与背景对比度满足可读性要求（建议达到 WCAG AA，优先 AAA）。

一、核心原则
- 统一用 CSS 变量，不直接写死颜色。避免 rgba(255,255,255,0.x) 这类浅白半透明在亮色下对比不足。
- 组件优先读主题变量：背景 var(--card-glass)、边框 var(--card-border)、文本 var(--text-*)、语义色 var(--flow-*)。
- 标签/胶囊统一使用“标签变量”三件套：--tag-*-bg、--tag-*-border、--tag-*-text（亮/暗两套已在 globals.css 定义）。

二、变量清单（片段）
- 卡片：
  - 背景：--card-glass
  - 边框：--card-border
  - 阴影：--card-shadow
- 文本：--text-primary、--text-secondary（亮色下不低于 #0f172a；必要时 #000）
- 语义：--flow-primary/secondary/accent
- 标签（亮/暗已分配）：
  - --tag-blue-bg / --tag-blue-border / --tag-blue-text
  - --tag-green-bg / --tag-green-border / --tag-green-text
  - --tag-red-bg / --tag-red-border / --tag-red-text
  - --tag-purple-bg / --tag-purple-border / --tag-purple-text

三、禁止模式（需要替换）
- 禁止：rgba(255,255,255,0.x)、bg-white/10、border-white/10 等浅白透明硬编码。
- 替换：
  - 背景 → var(--card-glass)
  - 边框 → var(--card-border)
  - 文本 → var(--text-muted|secondary|primary)
  - 彩色标签 → 对应 --tag-*-*

四、组件实现范式
- 徽章/胶囊（空态）：
  - 背景：var(--card-glass)
  - 边框：var(--card-border)
  - 文本：var(--text-muted)
- 已赋值的标签（彩色）：
  - 背景：--tag-*-bg
  - 边框：--tag-*-border
  - 文本：--tag-*-text
- 操作按钮（次级）：
  - 背景：var(--card-glass)
  - 边框：var(--card-border)
  - 文本：var(--text-secondary) 或 var(--text-muted)

五、调试与回归
- 亮色/暗色/两主题四象限自查：
  - 文字对比 ≥ 4.5:1（正文），≥ 7:1 为佳
  - 查看浏览器 DevTools 计算值，确认未命中白色半透明硬编码
- 视觉验证点：
  - 首页 Tab、EntryList 徽章/标签/按钮、弹层/调试组件

六、迁移指南（代码片段）
- 替换示例：
```tsx
// Before
style={{ backgroundColor: 'rgba(255,255,255,0.1)', borderColor: 'rgba(255,255,255,0.2)' }}

// After
style={{ backgroundColor: 'var(--card-glass)', borderColor: 'var(--card-border)' }}
```

- 标签彩色示例：
```tsx
style={{
  backgroundColor: 'var(--tag-blue-bg)',
  borderColor: 'var(--tag-blue-border)',
  color: 'var(--tag-blue-text)'
}}
```

七、后续建议
- 在 CI 增加 grep 审查（阻止新提交出现 rgba(255,255,255,0.x) / border-white/10 等模式）。
- 引入 Storybook 亮/暗快照，做视觉回归。
- 对外部 PR 执行样式 Lint（自定义 rule）。

