# 主题结构审查与对齐报告

## 目标
确保新主题沿用一致的命名与分层模式，避免破坏设计系统和令牌映射。

## 现有主题结构分析

### 1. 选择器结构 ✅

#### 当前实现完全符合要求：
- **亮色默认**：`:root` - 定义默认亮色主题
- **全局暗色覆盖**：`[data-color-scheme="dark"]` - 统一暗色模式覆盖
- **主题块结构**：
  - `[data-theme="warm"]` - 温暖主题（粉紫色系）
  - `[data-theme="cyber"]` - 科技未来主题（青色系）
  - `[data-theme="xxx"][data-color-scheme="dark"]` - 各主题的夜间模式覆盖

### 2. 变量分组一致性 ✅

#### 核心变量分组已标准化：

**背景/前景**：
```css
--background: /* 主背景色 */
--foreground: /* 主文本色 */
```

**基础色阶**（50-950 标准色阶）：
```css
--primary-50: #f0f9ff;
--primary-100: #e0f2fe;
/* ... 完整的色阶系统 ... */
--primary-950: #082f49;
```

**动态/品牌色**：
```css
--dynamic-primary: /* 主要动态色 */
--dynamic-secondary: /* 次要动态色 */
--dynamic-accent: /* 强调色 */
--dynamic-glow: /* 发光效果色 */
--dynamic-pulse: /* 脉冲效果色 */
```

**思维流动渐变**：
```css
--mind-flow-primary: linear-gradient(135deg, ...);
--mind-flow-secondary: linear-gradient(135deg, ...);
--mind-flow-accent: linear-gradient(135deg, ...);
--mind-flow-neutral: linear-gradient(135deg, ...);
```

**卡片材质**：
```css
--card-glass: /* 玻璃拟态背景 */
--card-border: /* 卡片边框 */
--card-shadow: /* 卡片阴影 */
```

**动态配色系统**：
```css
--flow-primary: /* 流动主色 */
--flow-secondary: /* 流动次色 */
--flow-accent: /* 流动强调 */
--flow-neutral: /* 流动中性 */
--flow-blue/cyan/sky/teal/indigo/slate: /* 具体颜色变量 */
```

**文本色彩**：
```css
--text-primary: /* 主文本 */
--text-secondary: /* 次文本 */
--text-muted: /* 静默文本 */
--text-accent: /* 强调文本 */
--text-success/warning/error: /* 状态文本 */
--text-on-primary: /* 主色上的文本 */
```

**标签色系统**：
```css
--tag-blue/green/red/purple/yellow/orange-bg/border/text: /* 完整标签色系 */
```

### 3. 设计令牌映射依赖 ✅

`src/styles/design-tokens.css` 正确使用以下变量作为语义色源：

```css
/* 品牌色映射 */
--color-primary: var(--dynamic-primary);
--color-primary-hover: var(--dynamic-secondary);
--color-primary-light: var(--dynamic-accent);

/* 背景色映射 */
--color-background: var(--background);
--color-background-elevated: var(--card-glass);

/* 边框色映射 */
--color-border: var(--card-border);
--color-border-hover: var(--dynamic-primary);

/* 文本色映射 */
--color-text-primary: var(--text-primary);
--color-text-secondary: var(--text-secondary);
--color-text-muted: var(--text-muted);
```

### 4. 发现的问题与建议

#### ⚠️ 待解决问题：

**Theme Lab 中的未定义变量**：
- `--panel-bg` 在 Theme Lab（第16和88行）中使用，但未在全局定义
- `--panel-border` 在 Theme Lab（第16和90行）中使用，但未在全局定义

#### 建议解决方案：

**选项1：统一到 card 变量（推荐）**
```css
/* 在 Theme Lab 中替换为： */
--card-glass /* 替代 --panel-bg */
--card-border /* 替代 --panel-border */
```

**选项2：添加别名定义**
```css
:root {
  /* 添加到全局变量中 */
  --panel-bg: var(--card-glass);
  --panel-border: var(--card-border);
}
```

## 主题扩展标准

### 新主题必须遵循的结构：

```css
/* 新主题示例：[data-theme="nature"] */
[data-theme="nature"] {
  /* 1. 背景/前景 - 必需 */
  --background: /* 主题背景 */;
  --foreground: /* 主题前景 */;
  
  /* 2. 基础色阶 - 必需完整50-950 */
  --primary-50 到 --primary-950: /* 完整色阶 */;
  
  /* 3. 动态/品牌 - 必需 */
  --dynamic-primary/secondary/accent/glow/pulse: /* 动态色 */;
  
  /* 4. 思维流动渐变 - 必需 */
  --mind-flow-primary/secondary/accent/neutral: /* 渐变定义 */;
  
  /* 5. 卡片材质 - 必需 */
  --card-glass/border/shadow: /* 材质定义 */;
  
  /* 6. 动态配色 - 必需 */
  --flow-primary/secondary/accent/neutral: /* 流动色彩 */;
  --flow-blue/cyan/sky/teal/indigo/slate: /* 具体色值 */;
  
  /* 7. 文本 - 必需 */
  --text-primary/secondary/muted/accent/success/warning/error/text-on-primary: /* 文本色 */;
  
  /* 8. 标签色 - 可选（全局已提供） */
  /* 主题块可选择性重定义，但不强制 */
}

/* 新主题夜间模式 */
[data-theme="nature"][data-color-scheme="dark"] {
  /* 夜间模式调整所有相关变量 */
}
```

## 兼容性保证

### 现有组件依赖检查 ✅

1. **Header 组件**：正确使用 `--flow-primary` 等变量
2. **卡片组件**：正确使用 `--card-glass`、`--card-border`、`--card-shadow`
3. **文本组件**：正确使用 `--text-*` 系列变量
4. **标签组件**：正确使用 `--tag-*` 系列变量

### 设计令牌映射完整性 ✅

`design-tokens.css` 中的所有映射都基于标准变量，新主题只需提供这些基础变量即可自动适配。

## 总结

### ✅ 已符合标准：
- 选择器结构层次清晰且一致
- 变量分组标准化且完整
- 设计令牌映射依赖关系明确
- 主题切换机制完善

### ⚠️ 需要处理：
- Theme Lab 中的 `--panel-bg` 和 `--panel-border` 变量定义
- 建议后续统一到 `--card-*` 变量系统

### 📋 新主题开发清单：
1. 按照标准结构定义所有必需变量
2. 确保提供明亮和暗色两套配色
3. 保持与现有设计令牌的兼容性
4. 测试 Theme Lab 页面的显示效果

---

**备注**：本报告基于当前代码结构分析，为新主题开发提供标准化指导，确保设计系统的一致性和可维护性。
