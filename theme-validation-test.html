<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æš—è‰²æ¨¡å¼é€‰æ‹©å™¨æ ¡éªŒ - Digital Brain</title>
    <link rel="stylesheet" href="src/app/globals.css">
    <link rel="stylesheet" href="src/styles/design-tokens.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--background);
            color: var(--foreground);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            transition: all 0.3s ease;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .controls {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
            background: var(--card-glass);
            border: 1px solid var(--card-border);
            border-radius: 12px;
            padding: 16px;
            backdrop-filter: blur(10px);
            min-width: 200px;
        }
        
        .btn {
            background: var(--color-primary);
            color: var(--color-text-on-primary);
            border: 1px solid var(--color-border);
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .btn:hover {
            background: var(--color-primary-hover);
            box-shadow: var(--shadow-glow);
        }
        
        .current-state {
            font-size: 12px;
            color: var(--text-secondary);
            padding: 8px;
            background: var(--color-background-subtle);
            border-radius: 6px;
            font-family: monospace;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-top: 20px;
        }
        
        .test-card {
            background: var(--color-background-elevated);
            border: 1px solid var(--color-border);
            border-radius: 16px;
            padding: 24px;
            box-shadow: var(--card-shadow);
        }
        
        .test-card h3 {
            color: var(--color-text-primary);
            margin: 0 0 16px 0;
            font-size: 18px;
        }
        
        .test-card p {
            color: var(--color-text-secondary);
            margin: 0 0 12px 0;
            line-height: 1.5;
        }
        
        .color-swatches {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin: 16px 0;
        }
        
        .color-swatch {
            height: 48px;
            border-radius: 8px;
            border: 1px solid var(--color-border);
            display: flex;
            align-items: end;
            justify-content: center;
            padding: 4px;
            font-size: 10px;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            font-weight: 500;
        }
        
        .validation-results {
            background: var(--color-background-elevated);
            border: 2px solid var(--color-border-success);
            border-radius: 12px;
            padding: 20px;
            margin: 24px 0;
        }
        
        .validation-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 8px 0;
            font-size: 14px;
        }
        
        .validation-item.pass::before {
            content: 'âœ…';
        }
        
        .validation-item.fail::before {
            content: 'âŒ';
        }
        
        .validation-item.pass {
            color: var(--color-success);
        }
        
        .validation-item.fail {
            color: var(--color-error);
        }
        
        .css-output {
            background: var(--color-background-subtle);
            border: 1px solid var(--color-border);
            border-radius: 8px;
            padding: 12px;
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            font-size: 12px;
            color: var(--text-primary);
            white-space: pre-wrap;
            overflow-x: auto;
        }
        
        .dopamine-demo {
            border-color: var(--dopamine-orange);
            box-shadow: 0 0 20px rgba(255, 107, 71, 0.3);
        }
        
        .digital-brain-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 24px 0;
        }
        
        .brain-card {
            padding: 20px;
            border-radius: 12px;
            color: white;
            text-align: center;
            font-weight: 600;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .card-processor { background: var(--card-processor, var(--dopamine-orange)); }
        .card-memory { background: var(--card-memory, var(--dopamine-green)); }
        .card-storage { background: var(--card-storage, var(--dopamine-light-green)); }
        .card-connection { background: var(--card-connection, var(--dopamine-indigo)); }
        .card-compact { background: var(--card-compact, var(--dopamine-yellow)); color: #333; }
        
        .focus-test {
            margin: 16px 0;
        }
        
        .focus-test input, .focus-test button {
            margin: 8px;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid var(--color-border);
            background: var(--color-background);
            color: var(--color-text-primary);
        }
        
        .focus-test input:focus, .focus-test button:focus {
            outline: 3px solid var(--color-primary);
            outline-offset: 2px;
        }
        
        .contrast-test {
            margin: 16px 0;
            padding: 16px;
            background: var(--color-background-elevated);
            border: 1px solid var(--color-border);
            border-radius: 8px;
        }
        
        .text-samples {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .text-sample {
            padding: 8px 12px;
            border-radius: 6px;
        }
        
        .text-on-bg { background: var(--color-background); color: var(--color-text-primary); }
        .text-on-card { background: var(--color-background-elevated); color: var(--color-text-secondary); }
        .text-on-primary { background: var(--color-primary); color: var(--color-text-on-primary); }
        
        .system-info {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--card-glass);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            padding: 12px;
            font-size: 12px;
            color: var(--text-muted);
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body>
    <div class="test-container">
        <!-- æ§åˆ¶é¢æ¿ -->
        <div class="controls">
            <h4 style="margin: 0 0 12px 0; color: var(--text-primary);">ä¸»é¢˜æ§åˆ¶</h4>
            <div class="current-state">
                <div>ä¸»é¢˜: <span id="current-theme">default</span></div>
                <div>é¢œè‰²: <span id="current-scheme">light</span></div>
            </div>
            
            <div style="margin: 12px 0 8px 0; font-size: 12px; color: var(--text-secondary);">ä¸»é¢˜é€‰æ‹©:</div>
            <button class="btn" onclick="setTheme('warm', null)">æ¸©æš–ç²‰è‰²</button>
            <button class="btn" onclick="setTheme('cyber', null)">ç§‘æŠ€æœªæ¥</button>
            <button class="btn" onclick="setTheme('forest', null)">æ£®æ—ç»¿</button>
            <button class="btn" onclick="setTheme('dopamine', null)">å¤šå·´èƒº</button>
            <button class="btn" onclick="setTheme('', null)">é»˜è®¤</button>
            
            <div style="margin: 12px 0 8px 0; font-size: 12px; color: var(--text-secondary);">è‰²å½©æ¨¡å¼:</div>
            <button class="btn" onclick="setTheme(null, 'light')">æ˜äº®æ¨¡å¼</button>
            <button class="btn" onclick="setTheme(null, 'dark')">æš—è‰²æ¨¡å¼</button>
            <button class="btn" onclick="setTheme(null, 'auto')">è·Ÿéšç³»ç»Ÿ</button>
            
            <div style="margin: 12px 0 8px 0; font-size: 12px; color: var(--text-secondary);">å¿«é€Ÿç»„åˆ:</div>
            <button class="btn" onclick="setTheme('dopamine', 'light')">å¤šå·´èƒºäº®è‰²</button>
            <button class="btn" onclick="setTheme('dopamine', 'dark')">å¤šå·´èƒºæš—è‰²</button>
        </div>
        
        <!-- é¡µé¢æ ‡é¢˜ -->
        <div style="text-align: center; margin-bottom: 32px;">
            <h1 style="color: var(--color-text-primary); margin: 0 0 8px 0;">æš—è‰²æ¨¡å¼é€‰æ‹©å™¨æ ¡éªŒ</h1>
            <p style="color: var(--color-text-secondary); margin: 0;">éªŒè¯ HTML é€‰æ‹©å™¨åœ¨ä¸åŒä¸»é¢˜å’Œè‰²å½©æ–¹æ¡ˆç»„åˆä¸‹çš„è¡Œä¸º</p>
        </div>
        
        <!-- éªŒè¯ç»“æœ -->
        <div class="validation-results">
            <h3 style="margin: 0 0 16px 0; color: var(--color-text-primary);">âœ¨ å®æ—¶éªŒè¯ç»“æœ</h3>
            <div id="validation-output">
                <!-- é€šè¿‡ JavaScript åŠ¨æ€å¡«å…… -->
            </div>
        </div>
        
        <!-- æµ‹è¯•ç½‘æ ¼ -->
        <div class="test-grid">
            <!-- é€‰æ‹©å™¨åŒ¹é…æµ‹è¯• -->
            <div class="test-card">
                <h3>é€‰æ‹©å™¨åŒ¹é…çŠ¶æ€</h3>
                <p>éªŒè¯å½“å‰ DOM çŠ¶æ€ä¸‹å„ç§é€‰æ‹©å™¨çš„åŒ¹é…æƒ…å†µï¼š</p>
                <div id="selector-status" class="css-output">
                    <!-- é€šè¿‡ JavaScript åŠ¨æ€å¡«å…… -->
                </div>
            </div>
            
            <!-- é¢œè‰²ä»¤ç‰Œæµ‹è¯• -->
            <div class="test-card">
                <h3>è®¾è®¡ä»¤ç‰Œæ˜ å°„</h3>
                <p>æ£€æŸ¥è®¾è®¡ä»¤ç‰Œæ˜¯å¦æ­£ç¡®æ˜ å°„åˆ°ä¸»é¢˜è‰²å½©å˜é‡ï¼š</p>
                <div class="color-swatches">
                    <div class="color-swatch" style="background: var(--color-primary)">Primary</div>
                    <div class="color-swatch" style="background: var(--color-primary-hover)">Hover</div>
                    <div class="color-swatch" style="background: var(--color-primary-light)">Light</div>
                    <div class="color-swatch" style="background: var(--color-success)">Success</div>
                </div>
            </div>
            
            <!-- å¯¹æ¯”åº¦æµ‹è¯• -->
            <div class="test-card">
                <h3>å¯è®¿é—®æ€§å¯¹æ¯”åº¦æµ‹è¯•</h3>
                <p>éªŒè¯æ–‡æœ¬ä¸èƒŒæ™¯çš„å¯¹æ¯”åº¦æ˜¯å¦è¾¾åˆ° AA çº§æ ‡å‡†ï¼ˆâ‰¥4.5:1ï¼‰ï¼š</p>
                <div class="text-samples">
                    <div class="text-sample text-on-bg">ä¸»èƒŒæ™¯ä¸Šçš„æ–‡æœ¬ (AAçº§æµ‹è¯•)</div>
                    <div class="text-sample text-on-card">å¡ç‰‡èƒŒæ™¯ä¸Šçš„æ–‡æœ¬ (AAçº§æµ‹è¯•)</div>
                    <div class="text-sample text-on-primary">ä¸»è‰²èƒŒæ™¯ä¸Šçš„æ–‡æœ¬ (AAçº§æµ‹è¯•)</div>
                </div>
                <div id="contrast-results" class="css-output" style="margin-top: 12px;">
                    <!-- å¯¹æ¯”åº¦ç»“æœå°†é€šè¿‡ JavaScript å¡«å…… -->
                </div>
            </div>
            
            <!-- ç„¦ç‚¹ç¯æµ‹è¯• -->
            <div class="test-card">
                <h3>ç„¦ç‚¹ç¯å¯è§æ€§æµ‹è¯•</h3>
                <p>éªŒè¯äº¤äº’å…ƒç´ çš„ç„¦ç‚¹ç¯æ˜¯å¦æ¸…æ™°å¯è§ï¼š</p>
                <div class="focus-test">
                    <input type="text" placeholder="æµ‹è¯•è¾“å…¥æ¡†ç„¦ç‚¹ç¯">
                    <button>æµ‹è¯•æŒ‰é’®ç„¦ç‚¹ç¯</button>
                    <br>
                    <button style="background: var(--color-primary); color: var(--color-text-on-primary);">ä¸»è‰²æŒ‰é’®ç„¦ç‚¹ç¯</button>
                </div>
                <p style="font-size: 12px; color: var(--text-muted); margin-top: 12px;">
                    è¯·ç”¨ Tab é”®å¯¼èˆªæˆ–ç‚¹å‡»å…ƒç´ æµ‹è¯•ç„¦ç‚¹ç¯å¯è§æ€§
                </p>
            </div>
        </div>
        
        <!-- Digital Brain ç³»ç»Ÿå¡ç‰‡æµ‹è¯• -->
        <div class="test-card" style="grid-column: 1 / -1;">
            <h3>Digital Brain ç³»ç»Ÿæ¨¡å—è‰²å½©éªŒè¯</h3>
            <p>éªŒè¯ digital-brain ç³»ç»Ÿçš„å¤„ç†å™¨/å†…å­˜/å­˜å‚¨/è¿æ¥/ç´§å‡‘è®¾è®¡å¡ç‰‡æ˜¯å¦åº”ç”¨äº†é¢„æœŸçš„è¯­ä¹‰ä»¤ç‰Œï¼š</p>
            <div class="digital-brain-cards">
                <div class="brain-card card-processor">
                    ğŸ”¥ å¤„ç†å™¨
                    <div style="font-size: 12px; margin-top: 8px;">--card-processor</div>
                </div>
                <div class="brain-card card-memory">
                    ğŸ’¾ å†…å­˜
                    <div style="font-size: 12px; margin-top: 8px;">--card-memory</div>
                </div>
                <div class="brain-card card-storage">
                    ğŸ’½ å­˜å‚¨
                    <div style="font-size: 12px; margin-top: 8px;">--card-storage</div>
                </div>
                <div class="brain-card card-connection">
                    ğŸŒ è¿æ¥
                    <div style="font-size: 12px; margin-top: 8px;">--card-connection</div>
                </div>
                <div class="brain-card card-compact">
                    âš¡ ç´§å‡‘è®¾è®¡
                    <div style="font-size: 12px; margin-top: 8px;">--card-compact</div>
                </div>
            </div>
        </div>
        
        <!-- CSS å˜é‡ç›‘æ§ -->
        <div class="test-card" style="grid-column: 1 / -1;">
            <h3>CSS å˜é‡å®æ—¶ç›‘æ§</h3>
            <p>å®æ—¶æ˜¾ç¤ºå½“å‰åº”ç”¨çš„ CSS å˜é‡å€¼ï¼š</p>
            <div id="css-variables" class="css-output">
                <!-- é€šè¿‡ JavaScript åŠ¨æ€å¡«å…… -->
            </div>
        </div>
    </div>
    
    <!-- ç³»ç»Ÿä¿¡æ¯ -->
    <div class="system-info">
        <div>User Agent Dark Mode: <span id="system-dark"></span></div>
        <div>Reduced Motion: <span id="reduced-motion"></span></div>
        <div>High Contrast: <span id="high-contrast"></span></div>
    </div>

    <script>
        // DOM å¼•ç”¨
        const html = document.documentElement;
        const currentThemeSpan = document.getElementById('current-theme');
        const currentSchemeSpan = document.getElementById('current-scheme');
        const validationOutput = document.getElementById('validation-output');
        const selectorStatus = document.getElementById('selector-status');
        const cssVariables = document.getElementById('css-variables');
        const contrastResults = document.getElementById('contrast-results');
        const systemDark = document.getElementById('system-dark');
        const reducedMotion = document.getElementById('reduced-motion');
        const highContrast = document.getElementById('high-contrast');
        
        // ä¸»é¢˜åˆ‡æ¢å‡½æ•°
        function setTheme(theme, colorScheme) {
            if (theme !== null) {
                if (theme) {
                    html.setAttribute('data-theme', theme);
                } else {
                    html.removeAttribute('data-theme');
                }
            }
            
            if (colorScheme !== null) {
                if (colorScheme === 'auto') {
                    html.setAttribute('data-color-scheme', 'auto');
                    // ç«‹å³åº”ç”¨ç³»ç»Ÿåå¥½
                    const actualScheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                    html.setAttribute('data-color-scheme', actualScheme);
                } else {
                    html.setAttribute('data-color-scheme', colorScheme);
                }
            }
            
            updateStatus();
        }
        
        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStatus() {
            const theme = html.getAttribute('data-theme') || 'default';
            const scheme = html.getAttribute('data-color-scheme') || 'light';
            
            currentThemeSpan.textContent = theme;
            currentSchemeSpan.textContent = scheme;
            
            validateSelectors();
            updateCSSVariables();
            updateSystemInfo();
        }
        
        // éªŒè¯é€‰æ‹©å™¨
        function validateSelectors() {
            const theme = html.getAttribute('data-theme');
            const isDark = html.getAttribute('data-color-scheme') === 'dark';
            
            // æµ‹è¯•é€‰æ‹©å™¨
            const selectors = {
                'html[data-theme="dopamine"]:not(.dark)': theme === 'dopamine' && !isDark,
                'html.dark[data-theme="dopamine"]': theme === 'dopamine' && isDark,
                'html[data-theme="dopamine"]': theme === 'dopamine',
                'html[data-color-scheme="dark"]': isDark,
                'html[data-color-scheme="light"]': !isDark,
                'html[data-theme="forest"]': theme === 'forest',
                'html[data-theme="warm"]': theme === 'warm',
                'html[data-theme="cyber"]': theme === 'cyber'
            };
            
            let selectorHtml = '';
            let validationHtml = '';
            
            for (const [selector, matches] in Object.entries(selectors)) {
                const status = matches ? 'âœ… åŒ¹é…' : 'âŒ ä¸åŒ¹é…';
                selectorHtml += `${selector}: ${status}\n`;
                
                if (selector.includes('dopamine')) {
                    const className = matches ? 'pass' : 'fail';
                    const message = matches ? 'å¤šå·´èƒºä¸»é¢˜é€‰æ‹©å™¨å·¥ä½œæ­£å¸¸' : 'å¤šå·´èƒºä¸»é¢˜é€‰æ‹©å™¨æœªåŒ¹é…';
                    validationHtml += `<div class="validation-item ${className}">${message}</div>`;
                }
            }
            
            selectorStatus.textContent = selectorHtml;
            
            // æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº† .dark ç±»è€Œä¸æ˜¯ data-color-scheme
            const hasDarkClass = html.classList.contains('dark');
            if (hasDarkClass) {
                validationHtml += `<div class="validation-item fail">âš ï¸ æ£€æµ‹åˆ°ä½¿ç”¨äº† .dark ç±»ï¼Œå»ºè®®ä½¿ç”¨ data-color-scheme="dark"</div>`;
            } else {
                validationHtml += `<div class="validation-item pass">ä½¿ç”¨æ ‡å‡†çš„ data-color-scheme å±æ€§</div>`;
            }
            
            // æ£€æŸ¥æ˜¯å¦æœ‰ data-mode å±æ€§
            const dataMode = html.getAttribute('data-mode');
            if (dataMode === 'dark') {
                validationHtml += `<div class="validation-item fail">âš ï¸ æ£€æµ‹åˆ°ä½¿ç”¨äº† data-mode="dark"ï¼Œå»ºè®®è¿ç§»åˆ° data-color-scheme="dark"</div>`;
            }
            
            validationOutput.innerHTML = validationHtml;
        }
        
        // æ›´æ–° CSS å˜é‡æ˜¾ç¤º
        function updateCSSVariables() {
            const computedStyles = getComputedStyle(html);
            const variables = [
                '--background',
                '--foreground', 
                '--color-primary',
                '--color-primary-hover',
                '--color-text-primary',
                '--color-text-secondary',
                '--card-glass',
                '--card-border',
                '--dopamine-orange',
                '--dopamine-green',
                '--dopamine-indigo',
                '--dynamic-primary',
                '--dynamic-secondary'
            ];
            
            let html_content = '';
            variables.forEach(variable => {
                const value = computedStyles.getPropertyValue(variable).trim();
                html_content += `${variable}: ${value || '(æœªå®šä¹‰)'}\n`;
            });
            
            cssVariables.textContent = html_content;
            
            // å¯¹æ¯”åº¦æ£€æŸ¥
            checkContrast();
        }
        
        // æ£€æŸ¥å¯¹æ¯”åº¦
        function checkContrast() {
            const computedStyles = getComputedStyle(html);
            
            // è·å–é¢œè‰²å€¼å¹¶è®¡ç®—å¯¹æ¯”åº¦ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼‰
            const bgColor = computedStyles.getPropertyValue('--background').trim();
            const textColor = computedStyles.getPropertyValue('--color-text-primary').trim();
            const primaryColor = computedStyles.getPropertyValue('--color-primary').trim();
            const textOnPrimary = computedStyles.getPropertyValue('--color-text-on-primary').trim();
            
            let contrastHtml = `èƒŒæ™¯è‰²: ${bgColor}\n`;
            contrastHtml += `ä¸»æ–‡æœ¬è‰²: ${textColor}\n`;
            contrastHtml += `ä¸»è‰²è°ƒ: ${primaryColor}\n`;
            contrastHtml += `ä¸»è‰²ä¸Šæ–‡æœ¬: ${textOnPrimary}\n\n`;
            contrastHtml += `æ³¨: å¯¹æ¯”åº¦è®¡ç®—éœ€è¦ä¸“é—¨çš„å·¥å…·ï¼Œæ­¤å¤„ä»…æ˜¾ç¤ºé¢œè‰²å€¼\n`;
            contrastHtml += `å»ºè®®ä½¿ç”¨ WebAIM Contrast Checker ç­‰å·¥å…·éªŒè¯ AA çº§æ ‡å‡†`;
            
            contrastResults.textContent = contrastHtml;
        }
        
        // æ›´æ–°ç³»ç»Ÿä¿¡æ¯
        function updateSystemInfo() {
            systemDark.textContent = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'Yes' : 'No';
            reducedMotion.textContent = window.matchMedia('(prefers-reduced-motion: reduce)').matches ? 'Yes' : 'No';
            highContrast.textContent = window.matchMedia('(prefers-contrast: high)').matches ? 'Yes' : 'No';
        }
        
        // ç›‘å¬ç³»ç»Ÿä¸»é¢˜å˜åŒ–
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            if (html.getAttribute('data-color-scheme') === 'auto') {
                html.setAttribute('data-color-scheme', e.matches ? 'dark' : 'light');
                updateStatus();
            }
        });
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            // è®¾ç½®åˆå§‹ä¸»é¢˜ï¼ˆå¤šå·´èƒºäº®è‰²ï¼‰
            setTheme('dopamine', 'light');
            updateStatus();
            
            // å®šæœŸæ›´æ–°çŠ¶æ€
            setInterval(updateStatus, 1000);
        });
        
        // é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', (e) => {
            if (e.altKey && e.shiftKey) {
                switch(e.key) {
                    case '1': setTheme('warm', null); break;
                    case '2': setTheme('cyber', null); break;
                    case '3': setTheme('forest', null); break;
                    case '4': setTheme('dopamine', null); break;
                    case 'L': setTheme(null, 'light'); break;
                    case 'D': setTheme(null, 'dark'); break;
                    case 'A': setTheme(null, 'auto'); break;
                }
            }
        });
    </script>
</body>
</html>
